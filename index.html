<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSW News Portal - Suansri Wittaya School</title>
    <style>
        /* --- CSS STYLING: Global Variables & Base Styles --- */
        :root {
            --ssw-green: #004d40; 
            --ssw-yellow: #ffc107; 
            --light-bg: #f4f4f4;
            --text-dark: #333;
            --text-light: #fff;
            --border-color: #ccc;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --danger-color: #dc3545; 
            --info-color: #007bff; /* ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏û‡∏™‡∏ï‡πå */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--light-bg);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* --- LOGIN CONTAINER STYLES --- */
        .login-page {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            background-color: #f0f0f0; 
        }

        .login-container {
            background-color: var(--text-light);
            padding: 40px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .header { margin-bottom: 30px; }
        .logo { width: 80px; height: 80px; margin-bottom: 10px; border-radius: 50%; }
        .header h1 { color: var(--ssw-green); margin-top: 0; margin-bottom: 5px; font-size: 2em; }
        .header p { color: var(--text-dark); font-size: 0.9em; font-weight: 300; }

        /* Login Type Selection Buttons */
        .login-type-selection {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        .login-type-selection button {
            flex: 1;
            padding: 10px;
            border: 2px solid var(--ssw-green);
            background-color: var(--ssw-green);
            color: var(--ssw-yellow);
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s, opacity 0.3s;
        }
        .login-type-selection button.inactive {
            background-color: transparent;
            color: var(--ssw-green);
            border-color: #e0e0e0;
        }
        .login-type-selection button:hover:not(.inactive) {
            background-color: #00332a;
        }

        /* Form Styling */
        .login-form-content { border-top: 1px solid #eee; padding-top: 20px; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; font-weight: bold; color: var(--text-dark); font-size: 0.95em; }
        .input-group input, .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-sizing: border-box; 
            font-size: 1em;
            transition: border-color 0.3s;
        }
        .input-group input:focus, .input-group textarea:focus { border-color: var(--ssw-green); outline: none; box-shadow: 0 0 5px rgba(0, 77, 64, 0.3); }

        /* Button Styling */
        .action-button {
            width: 100%;
            padding: 12px;
            background-color: var(--ssw-green); 
            color: var(--ssw-yellow); 
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            margin-top: 10px;
            transition: background-color 0.3s, transform 0.1s;
        }
        .action-button:hover { background-color: #00332a; }
        .action-button:active { transform: translateY(1px); }
        .post-button { background-color: var(--info-color); color: white; margin-top: 0; }
        .post-button:hover { background-color: #0056b3; }


        /* --- NEWS CONTENT STYLES --- */
        #news-content {
            display: none; 
        }

        header {
            background-color: var(--ssw-green);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        header h1 { margin: 0; font-size: 2.5em; letter-spacing: 2px; }
        header p { margin: 5px 0 0; font-size: 1.1em; color: #b2dfdb; }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 10px;
        }

        /* Post Creation Form */
        #post-creation-form {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
        }
        #post-creation-form h2 {
            margin-top: 0;
            color: var(--info-color);
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .news-article {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
            position: relative;
        }

        .news-article h2 { color: var(--ssw-green); font-size: 1.5em; margin-top: 0; }
        .news-article .date { 
            display: block; 
            margin-bottom: 5px; 
            font-size: 0.9em; 
            color: #777; 
        }
        .news-article .author {
            font-size: 0.8em;
            color: var(--info-color);
            margin-bottom: 10px;
            display: block;
            font-style: italic;
        }
        
        .read-more-btn {
            display: inline-block;
            background-color: var(--ssw-yellow);
            color: var(--ssw-green);
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.3s;
            margin-right: 10px;
        }

        /* ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö */
        .delete-btn {
            background-color: var(--danger-color);
            color: white;
            padding: 6px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
            float: right; 
            font-size: 0.9em;
            margin-left: 10px;
        }
        .delete-btn:hover { background-color: #c82333; }
        
        /* ‡∏Ñ‡∏•‡∏≤‡∏™‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö (Admin vs User) */
        .hide-delete-btn { display: none !important; }

        footer {
            text-align: center;
            padding: 20px 0;
            margin-top: 30px;
            background-color: var(--ssw-green);
            color: white;
        }
    </style>
</head>
<body>

    <div id="login-page" class="login-page">
        <div class="login-container">
            <div class="header">
                <img src="https://via.placeholder.com/80/004d40/ffc107?text=SSW" alt="Suansri Wittaya School Logo" class="logo">
                <h1>SSW News Portal</h1>
                <p id="login-status-message">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
            </div>

            <div class="login-type-selection">
                <button id="user-btn" onclick="setLoginMode('user')">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</button>
                <button id="admin-btn" onclick="setLoginMode('admin')" class="inactive">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•/‡∏ô‡∏±‡∏Å‡∏Ç‡πà‡∏≤‡∏ß</button>
            </div>

            <div class="login-form-content">
                
                <div id="instant-login-message">
                    <p>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö! ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥ IP ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡πÑ‡∏î‡πâ <span id="ip-display"></span></p>
                    <button class="action-button" style="width: auto; padding: 8px 15px;" onclick="instantLogin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</button>
                    <button style="border: none; background: none; color: #555; text-decoration: underline; margin-left: 10px;" onclick="showAdminForm()">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏â‡∏±‡∏ô</button>
                </div>
                
                <form id="user-login-form">
                    <p style="font-size: 1.1em; font-weight: bold; color: var(--ssw-green);">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ç‡πà‡∏≤‡∏ß</p>
                    <div class="input-group">
                        <label for="visitor-username">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏û‡∏™‡∏ï‡πå)</label>
                        <input type="text" id="visitor-username" name="visitor-username" placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" required>
                    </div>
                    <button type="submit" class="action-button">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (User Access)</button>
                </form>

                <form id="admin-login-form" style="display: none;">
                    <div class="input-group">
                        <label for="admin-username">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Admin/Reporter)</label>
                        <input type="text" id="admin-username" name="admin-username" placeholder="Jocey778 ‡∏´‡∏£‡∏∑‡∏≠ sswadmin" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="admin-password">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password)</label>
                        <input type="password" id="admin-password" name="admin-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    
                    <button type="submit" class="action-button">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</button>
                </form>
            </div>
        </div>
    </div>

    <div id="news-content">
        <header>
            <h1>SSW News üì¢</h1>
            <p>Suansri Wittaya School Official News & Announcements</p>
        </header>

        <div class="container">
             <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <p style="margin: 0;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞: <strong id="logged-in-user-display"></strong></p>
                <button class="read-more-btn" onclick="logout()" style="float: right;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
             </div>
            
            <div id="post-creation-form">
                <h2>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà</h2>
                <form id="new-post-form">
                    <div class="input-group">
                        <label for="post-title">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ç‡πà‡∏≤‡∏ß</label>
                        <input type="text" id="post-title" required>
                    </div>
                    <div class="input-group">
                        <label for="post-content">‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Ç‡πà‡∏≤‡∏ß‡πÇ‡∏î‡∏¢‡∏¢‡πà‡∏≠</label>
                        <textarea id="post-content" rows="3" required></textarea>
                    </div>
                    <button type="submit" class="action-button post-button">‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ç‡πà‡∏≤‡∏ß</button>
                </form>
            </div>

            <div class="news-grid" id="news-grid">
                </div>
        </div>

        <footer>
            <p>&copy; 2025 Suansri Wittaya School. All Rights Reserved.</p>
        </footer>
    </div>


    <script>
        // --- CONSTANTS AND ELEMENTS ---
        const LOCAL_STORAGE_KEY = 'ssw_news_posts';
        const ADMIN_IP_KEY = 'ssw_admin_ip';
        const POSTS_CONTAINER = document.getElementById('news-grid');
        const NEW_POST_FORM = document.getElementById('new-post-form');

        const LOGIN_PAGE = document.getElementById('login-page');
        const NEWS_CONTENT = document.getElementById('news-content');
        const USER_FORM = document.getElementById('user-login-form');
        const ADMIN_FORM = document.getElementById('admin-login-form');
        const INSTANT_MESSAGE = document.getElementById('instant-login-message');
        const IP_DISPLAY = document.getElementById('ip-display');
        const STATUS_MESSAGE = document.getElementById('login-status-message');
        const USER_BTN = document.getElementById('user-btn');
        const ADMIN_BTN = document.getElementById('admin-btn');
        const LOGGED_IN_USER_DISPLAY = document.getElementById('logged-in-user-display');
        const POST_CREATION_FORM = document.getElementById('post-creation-form');

        // Admin Accounts
        const VALID_CREDENTIALS = {
            'sswadmin': '1234',
            'Jocey778': 'password'
        };

        // Current User State
        let currentUser = { id: null, username: null, role: null };
        let lastKnownPosts = '';
        let refreshInterval;
        
        // Initialize Default Posts (only if localStorage is empty)
        function initializeDefaultPosts() {
            if (!localStorage.getItem(LOCAL_STORAGE_KEY)) {
                const defaultPosts = [
                    { id: Date.now() + 1, title: 'Outstanding Student Achievement in Science Fair', content: 'The SSW Science Club secured first place at the Regional Science & Technology Fair this past week. Kudos to the team for their innovative project on renewable energy!', date: 'November 13, 2025', authorId: 'admin_sswadmin', authorName: 'SSW Admin', role: 'admin' },
                    { id: Date.now() + 2, title: 'Annual Sports Day Rescheduled', content: 'Due to unforeseen weather conditions, the Annual Sports Day has been moved to Friday, November 29th. Please check the school board for updated event schedules.', date: 'November 10, 2025', authorId: 'admin_Jocey778', authorName: 'Jocey778 (Reporter)', role: 'admin' },
                    { id: Date.now() + 3, title: 'New Library Resource Center Opens', content: 'Students can now access our brand-new digital resource center in the main library building. It features 20 new workstations and high-speed internet.', date: 'November 5, 2025', authorId: 'user_visitor', authorName: 'Visitor', role: 'user' },
                ];
                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(defaultPosts));
            }
        }
        initializeDefaultPosts();

        // --- CORE DATA FUNCTIONS ---

        function getPosts() {
            try {
                return JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY)) || [];
            } catch (e) {
                console.error("Error parsing posts from localStorage:", e);
                return [];
            }
        }

        function savePosts(posts) {
            localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(posts));
            // Force re-render on save to simulate instant update on current screen
            renderPosts(); 
        }
        
        // --- REAL-TIME SIMULATION ---
        
        function startRealTimeCheck() {
            if (refreshInterval) clearInterval(refreshInterval);
            refreshInterval = setInterval(renderPosts, 1000); // Check every 1 second
            console.log("Real-time check started.");
        }

        function stopRealTimeCheck() {
            if (refreshInterval) clearInterval(refreshInterval);
            console.log("Real-time check stopped.");
        }

        // --- RENDERING FUNCTIONS ---

        function renderPosts() {
            const posts = getPosts().sort((a, b) => b.id - a.id); // Sort newest first
            const postsString = JSON.stringify(posts);

            // Only re-render if data has actually changed
            if (postsString === lastKnownPosts) return; 
            lastKnownPosts = postsString;

            let html = '';
            
            posts.forEach(post => {
                // Determine if the delete button should be visible (Admin can delete all, User can delete own)
                let showDeleteButton = false;
                if (currentUser.role === 'admin') {
                    showDeleteButton = true;
                } else if (currentUser.role === 'user' && currentUser.id === post.authorId) {
                    showDeleteButton = true;
                }
                
                const deleteButtonHtml = showDeleteButton 
                    ? `<button class="delete-btn" onclick="deleteArticle(${post.id})">‡∏•‡∏ö X</button>`
                    : '';
                
                const articleHtml = `
                    <div class="news-article" id="article-${post.id}">
                        ${deleteButtonHtml}
                        <span class="date">${post.date}</span>
                        <span class="author">‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÇ‡∏î‡∏¢: ${post.authorName}</span>
                        <h2>${post.title}</h2>
                        <p>${post.content}</p>
                        <button class="read-more-btn" onclick="showArticleDetails('${post.title}')">Read More</button>
                    </div>
                `;
                html += articleHtml;
            });

            POSTS_CONTAINER.innerHTML = html;
        }


        // --- ACTION HANDLERS ---
        
        // Handle Post Submission
        NEW_POST_FORM.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('post-title').value;
            const content = document.getElementById('post-content').value;
            
            if (!currentUser.id) {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏û‡∏ö ID ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà");
                return;
            }

            const newPost = {
                id: Date.now(),
                title: title,
                content: content,
                date: new Date().toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' }),
                authorId: currentUser.id,
                authorName: currentUser.username,
                role: currentUser.role
            };

            const posts = getPosts();
            posts.push(newPost);
            savePosts(posts); // Save posts and re-render
            
            NEW_POST_FORM.reset();
            alert(`‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà "${title}" ‡∏ñ‡∏π‡∏Å‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡πÅ‡∏•‡πâ‡∏ß!`);
        });
        
        // Handle Delete Article
        window.deleteArticle = function(postId) {
            const posts = getPosts();
            const postIndex = posts.findIndex(p => p.id === postId);
            
            if (postIndex === -1) {
                alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ");
                return;
            }
            
            const post = posts[postIndex];
            
            // Authorization Check
            let authorized = false;
            if (currentUser.role === 'admin') {
                authorized = true; // Admin can delete any
            } else if (currentUser.role === 'user' && currentUser.id === post.authorId) {
                authorized = true; // User can only delete own posts
            }
            
            if (!authorized) {
                alert("‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏ö‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ");
                return;
            }

            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°: "${post.title}"? (‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠)`)) {
                posts.splice(postIndex, 1);
                savePosts(posts);
                alert(`‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° "${post.title}" ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß`);
            }
        }
        
        // --- LOGIN/FLOW FUNCTIONS ---

        async function getClientIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                return null;
            }
        }

        function showNewsContent(user) {
            currentUser = user; // Set global user state
            LOGIN_PAGE.style.display = 'none';
            NEWS_CONTENT.style.display = 'block';
            document.body.style.backgroundColor = 'var(--light-bg)';
            LOGGED_IN_USER_DISPLAY.textContent = `${user.username} (${user.role === 'admin' ? '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•' : '‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å'})`;
            POST_CREATION_FORM.style.display = 'block'; // Show post form for all logged-in users
            
            renderPosts(); // Initial render
            startRealTimeCheck(); // Start continuous check for updates
        }

        function logout() {
            stopRealTimeCheck();
            alert('‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß');
            currentUser = { id: null, username: null, role: null };
            NEWS_CONTENT.style.display = 'none';
            LOGIN_PAGE.style.display = 'flex';
            setLoginMode('user');
        }

        function showArticleDetails(articleTitle) {
            alert(`Viewing more details for: ${articleTitle}\n\n(‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏à‡∏£‡∏¥‡∏á ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡πà‡∏≤‡∏ß‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°)`);
        }
        
        function setLoginMode(mode) {
            stopRealTimeCheck();
            USER_BTN.classList.remove('inactive');
            ADMIN_BTN.classList.remove('inactive');
            
            USER_FORM.style.display = 'none';
            ADMIN_FORM.style.display = 'none';
            INSTANT_MESSAGE.style.display = 'none';

            if (mode === 'user') {
                ADMIN_BTN.classList.add('inactive');
                STATUS_MESSAGE.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ';
                USER_FORM.style.display = 'block';
            } else if (mode === 'admin') {
                USER_BTN.classList.add('inactive');
                STATUS_MESSAGE.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•/‡∏ô‡∏±‡∏Å‡∏Ç‡πà‡∏≤‡∏ß';
                checkInstantLogin(); 
            }
        }

        function showAdminForm() {
            INSTANT_MESSAGE.style.display = 'none';
            ADMIN_FORM.style.display = 'block';
        }

        async function checkInstantLogin() {
            const storedIP = localStorage.getItem(ADMIN_IP_KEY);
            const currentIP = await getClientIP();
            
            if (storedIP && currentIP && storedIP === currentIP) {
                ADMIN_FORM.style.display = 'none';
                IP_DISPLAY.textContent = `(${currentIP})`;
                INSTANT_MESSAGE.style.display = 'block';
            } else {
                showAdminForm();
            }
        }

        function instantLogin() {
            // Find a default admin user for instant login
            const defaultAdminUsername = Object.keys(VALID_CREDENTIALS)[0]; 
            showNewsContent({ 
                id: `admin_${defaultAdminUsername}`, 
                username: defaultAdminUsername, 
                role: 'admin' 
            });
        }

        // --- EVENT LISTENERS ---

        // 1. Handle User Login (Visitor Access)
        USER_FORM.addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('visitor-username').value;
            showNewsContent({ id: `user_${username}`, username: username, role: 'user' });
        });

        // 2. Handle Admin Login (Credential Check)
        ADMIN_FORM.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;

            if (VALID_CREDENTIALS[username] === password) { 
                const currentIP = await getClientIP();
                if (currentIP) {
                    localStorage.setItem(ADMIN_IP_KEY, currentIP);
                } 
                showNewsContent({ id: `admin_${username}`, username: username, role: 'admin' });
            } else {
                 alert('‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö: sswadmin/1234 ‡∏´‡∏£‡∏∑‡∏≠ Jocey778/password)');
            }
        });

        // Run default mode check when the page loads
        setLoginMode('user'); 
    </script>
</body>
</html>
